ICalRender={},function(){"use strict";Date.prototype.addDays=function(e){var t=new Date(this.valueOf());return t.setDate(t.getDate()+e),t},Date.prototype.sameDayAs=function(e){return this.getFullYear()===e.getFullYear()&&this.getMonth()===e.getMonth()&&this.getDate()===e.getDate()},ICalRender.Filters={filterEventsToParticularDayEvents:function(e){var t=function(t){var n=new Date(t.startDate),a=new Date(t.endDate),r=n.sameDayAs(e)&&!(0===n.getUTCHours()&&!a.sameDayAs(e));return r};return t},filterEventsToTimeWindow:function(e,t,n){var a=function(a){var r=new ICalRender.ExtendedEvent(a),s=new Date(e.getFullYear(),e.getMonth(),e.getDate(),t,0,0,0),i=new Date(e.getFullYear(),e.getMonth(),e.getDate(),n,0,0,0);return r.overlapsWithTimeRange(s,i)};return a},filterEventsToAllDayEvents:function(e){var t=function(t){var n=new Date(t.startDate),a=new Date(t.endDate),r=n.sameDayAs(e)&&0===n.getUTCHours()&&a.getDate()!==e.getDate();return r};return t}}}(),function(){"use strict";ICalRender.EventPosition=function(){this.eventIndent=0,this.neighbourEvents=1},ICalRender.ExtendedEvent=function(e){this.basicEvent=e,this.startDate=new Date(e.startDate),this.endDate=new Date(e.endDate),this.processed=0,this.eventPosition=new ICalRender.EventPosition},ICalRender.ExtendedEvent.prototype={overlapsWithTimeRange:function(e,t){return this.startDate<t&&this.endDate>e},overlaps:function(e){return this.startDate<e.endDate&&this.endDate>e.startDate},overlapsWithAny:function(e){var t=this,n=!1;return e.forEach(function(e){t.startDate<e.endDate&&t.endDate>e.startDate&&(n=!0)}),n},findOverlapping:function(e){var t=this,n=[];return e.forEach(function(e){t.overlaps(e)&&n.push(e)}),n}}}(),ICalRender.EventPositionCalculator=function(e){var t=this,n=e.sort(function(e,t){var n=new Date(e.startDate),a=new Date(t.startDate);return n-a});t.orderedEvents=[],n.forEach(function(e){var n=new ICalRender.ExtendedEvent(e);t.orderedEvents.push(n)})},ICalRender.EventPositionCalculator.prototype={getFunProcessEventForIteration:function(e,t){var n=function(n){n.overlapsWithAny(t.filter(function(t){return t.processed==e}))||(n.processed=e,n.eventPosition.eventIndent=e-1)};return n},getFunFilterToIterationNumber:function(e){var t=function(t){return t.processed==e};return t},getFunSetNumOfNeighbours:function(e,t){var n=function(n){var a=n.findOverlapping(t);a.forEach(function(t){t.eventPosition.neighbourEvents=e})};return n},getEvents:function(){var e=this,t=7,n=1;for(n=1;t>n;n++){var a=e.orderedEvents.filter(function(e){return 0===e.processed}),r=this.getFunProcessEventForIteration(n,e.orderedEvents);a.forEach(r)}for(n=2;t>n;n++){var s=this.getFunFilterToIterationNumber(n),i=e.orderedEvents.filter(s),o=this.getFunSetNumOfNeighbours(n,e.orderedEvents);i.forEach(o)}for(var d=0;d<e.orderedEvents.length;d++)for(var u=d+1;u<e.orderedEvents.length;u++)if(e.orderedEvents[d].overlaps(e.orderedEvents[u])){var v=Math.max(e.orderedEvents[d].eventPosition.neighbourEvents,e.orderedEvents[u].eventPosition.neighbourEvents);e.orderedEvents[d].eventPosition.neighbourEvents=v,e.orderedEvents[u].eventPosition.neighbourEvents=v}return this.orderedEvents}},function(){"use strict";ICalRender.Renderer=function(e,t,n,a){if(this.fileContent=e,this.parsedCalendarEvents=[],this.startHour=t?t:0,this.endHour=n?n:24,isNaN(this.startHour)||this.startHour<0||this.startHour>23)throw"startHourParam value is out of range of valid values";if(isNaN(this.endHour)||this.endHour<1||this.endHour>24)throw"endHourParam value is out of range of valid values";isNaN(a)&&(a=50),this.allDayEventsSectionHeightPx=a;var r=ICAL.parse(this.fileContent);if(r){var s=this,i=new ICAL.Component(r),o=i.getAllSubcomponents("vevent");o.forEach(function(e){var t=new ICAL.Event(e,{});s.parsedCalendarEvents.push(t)})}},ICalRender.Renderer.prototype={getFunAddEventToContainer:function(e,t){return function(n){$("<div/>",{"class":"event all-day-event","data-day":t,text:n.summary,title:n.summary}).appendTo(e)}},getFunAddScheduledEventToContainer:function(e,t){return function(n){var a=new Date(n.basicEvent.startDate),r=new Date(n.basicEvent.endDate),s=60*a.getHours()+a.getMinutes(),i=(r-a)/6e4;$("<div />",{"class":"event scheduled-event","data-starttotalminutes":s,"data-duration":i,"data-numevents":n.eventPosition.neighbourEvents,"data-eventord":n.eventPosition.eventIndent,"data-day":t,title:n.basicEvent.summary,text:n.basicEvent.summary}).appendTo(e)}},RenderMultidayView:function(e,t,n,a,r){r||(r=1);var s=this;this.RenderDaysInternal(t,n,a,r,e),jQuery(e).addClass("days"),s.RealignDays(e),window.addEventListener("resize",function(){s.RealignDays(e)})},RenderDaysInternal:function(e,t,n,a,r){var s=this;t-=1;var i=$(r);i.empty(),i.data("numdays",a);var o=$("<div />",{"class":"headers"}).appendTo(i),d=$("<div />",{"class":"all-day-events"}).height(s.allDayEventsSectionHeightPx).appendTo(i);$("<div />",{"class":"all-day-events-divider"}).appendTo(i);for(var u=$("<div />",{"class":"scheduled-events"}).appendTo(i),v=$("<div/>",{"class":"time-grid"}).appendTo(u),h=this.startHour;h<this.endHour+1;h++)$("<span />",{"class":"time-grid-hour time-grid-hour-"+h,"data-hournumber":h,text:h}).appendTo(v),$("<div />",{"class":"time-grid-line","data-hournumber":h}).appendTo(v);for(var l=new Date(e,t,n),c=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],f=0;a>f;f++){$("<div />",{"class":"day-label","data-day":f,text:c[l.getDay()]+", "+l.toLocaleDateString()}).appendTo(o);var p=ICalRender.Filters.filterEventsToAllDayEvents(l),E=this.parsedCalendarEvents.filter(p),g=ICalRender.Filters.filterEventsToParticularDayEvents(l),D=ICalRender.Filters.filterEventsToTimeWindow(l,s.startHour,s.endHour),y=this.parsedCalendarEvents.filter(g).filter(D),m=this.getFunAddEventToContainer(d,f);E.forEach(m);var C=new ICalRender.EventPositionCalculator(y);y=C.getEvents();var w=this.getFunAddScheduledEventToContainer(u,f);y.forEach(w),l=l.addDays(1)}},RealignDays:function(e){var t=this,n=$(e),a=n.width(),r=(n.height(),n.data("numdays")),s=40,i=1,o=1==r?0:5,d=5,u=20,v=22,h=-6+d,l=20,c=n.width()-l-u,f=(a-u-l)/r-o,p=n.find(".headers").outerHeight(!0),E=n.find(".all-day-events").outerHeight(!0),g=n.find(".all-day-events-divider").outerHeight(!0),D=n.height()-p-E-g-d;n.find(".day-label").each(function(){var e=$(this).data("day"),t=0,n=u+e*(f+o);$(this).css("position","absolute").css("top",t+"px").css("left",n+"px").css("width",f+"px")});var y=[];n.find(".event.all-day-event").each(function(){var e=$(this).data("day");void 0!==y[e]?y[e]=y[e]+v+i:y[e]=0;var t=y[e],n=u+e*(f+o);$(this).css("position","absolute").css("top",t+"px").css("left",n+"px").css("width",f+"px").css("height",v+"px")}),n.find(".event.scheduled-event").each(function(){var e=$(this).data("day"),n=$(this).data("starttotalminutes"),a=$(this).data("duration"),i=$(this).data("numevents"),v=$(this).data("eventord"),h=(t.endHour-t.startHour)*(s+1),l=d+(n/60-t.startHour)*(s+1),f=c/r-o,p=f/i,E=e*(f+o)+u+v*(p+1),g=s*a/60;g=Math.min(g,h-l+d),0>l&&(g+=l+d,l=d),$(this).css("position","absolute").css("top",l+"px").css("left",E+"px").css("width",p+"px").css("height",g+"px")}),n.find(".time-grid-hour").each(function(){var e=$(this).data("hournumber"),n=(s+i)*(e-t.startHour)+h;$(this).css("top",n+"px")}),n.find(".time-grid-line").each(function(){var e=($(this).data("hournumber"),s);$(this).css("margin-bottom",e+"px")}),n.find(".scheduled-events").each(function(){$(this).height(D)})}}}();